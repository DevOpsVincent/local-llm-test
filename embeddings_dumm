import faiss
from langchain import FAISS
import create_embeddings
from langchain.embeddings import HuggingFaceEmbeddings
import itertools


new_db = FAISS.load_local("./faiss_index/", HuggingFaceEmbeddings(model_name="paraphrase-MiniLM-L6-v2"))

users_question="Wie sieht die Zukunft des Online-Bankgesch√§fts aus?"

split_data = list(itertools.chain.from_iterable(map(create_embeddings.split_text, [users_question])))

embedder=create_embeddings.Embed()
embeddings_data=embedder(split_data)

user_embeddings = FAISS.from_embeddings(
    embeddings_data,
    embedding=HuggingFaceEmbeddings(model_name="paraphrase-MiniLM-L6-v2")
)

print(FAISS.similarity_search_by_vector(new_db, user_embeddings))
